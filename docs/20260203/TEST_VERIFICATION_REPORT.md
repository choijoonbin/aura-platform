# ν…μ¤νΈ λ³΄μ™„ κ²€μ¦ λ³΄κ³ μ„

## π“… κ²€μ¦ μΌμ‹
2026-01-16

## β… λ³΄μ™„ μ„±κ³µ ν™•μΈ

### ν…μ¤νΈ κ²°κ³Ό μ”μ•½

| ν…μ¤νΈ ν•­λ© | μƒνƒ | κ²°κ³Ό |
|-----------|------|------|
| `/agents/tools` (μ¬λ°”λ¥Έ ν† ν°) | β… **μ„±κ³µ** | λ„κµ¬ λ©λ΅ μ •μƒ λ°ν™ |
| `/agents/tools` (ν† ν° μ—†μ΄) | β… **μ„±κ³µ** | 401 Unauthorized |
| `/agents/tools` (μλ»λ ν† ν°) | β… **μ„±κ³µ** | 401 Unauthorized |
| `/agents/health` (κ³µκ°) | β… **μ„±κ³µ** | μ •μƒ μ‘λ‹µ |
| JWT ν† ν° μƒμ„±/κ²€μ¦ | β… **μ„±κ³µ** | μ •μƒ μ‘λ™ |

---

## π“ μƒμ„Έ ν…μ¤νΈ κ²°κ³Ό

### 1. `/agents/tools` μ—”λ“ν¬μΈνΈ μΈμ¦ ν…μ¤νΈ β…

#### ν…μ¤νΈ 1: μ¬λ°”λ¥Έ ν† ν° μ‚¬μ©
```bash
curl http://localhost:8000/agents/tools \
  -H "Authorization: Bearer $TOKEN" \
  -H "X-Tenant-ID: tenant1"
```

**κ²°κ³Ό**: β… **μ„±κ³µ**
- HTTP Status: 200 OK
- μ‘λ‹µ: λ„κµ¬ λ©λ΅ μ •μƒ λ°ν™
- λ„κµ¬ κ°μ: 9κ° (Git 5κ° + GitHub 4κ°)
- μ²« λ²μ§Έ λ„κµ¬: `git_diff`

**μ‘λ‹µ μμ‹**:
```json
{
    "tools": [
        {
            "name": "git_diff",
            "description": "Git diffλ¥Ό μ΅°νν•©λ‹λ‹¤.",
            "args": {...}
        },
        ...
    ],
    "count": 9
}
```

#### ν…μ¤νΈ 2: ν† ν° μ—†μ΄ μ”μ²­
```bash
curl http://localhost:8000/agents/tools
```

**κ²°κ³Ό**: β… **μ„±κ³µ**
- HTTP Status: 401 Unauthorized
- μ‘λ‹µ: `{"detail":"Not authenticated"}`

#### ν…μ¤νΈ 3: μλ»λ ν† ν° μ‚¬μ©
```bash
curl http://localhost:8000/agents/tools \
  -H "Authorization: Bearer invalid_token_12345"
```

**κ²°κ³Ό**: β… **μ„±κ³µ**
- HTTP Status: 401 Unauthorized
- μ‘λ‹µ: `{"detail":"Not authenticated"}`

---

### 2. κ³µκ° μ—”λ“ν¬μΈνΈ ν…μ¤νΈ β…

#### `/agents/health` (μΈμ¦ λ¶ν•„μ”)
```bash
curl http://localhost:8000/agents/health
```

**κ²°κ³Ό**: β… **μ„±κ³µ**
- HTTP Status: 200 OK
- μ‘λ‹µ:
```json
{
    "status": "healthy",
    "agent_initialized": true,
    "tools_count": 9
}
```

**ν™•μΈ μ‚¬ν•­**:
- EXEMPT_PATHSμ— `/agents/health`κ°€ μ¶”κ°€λμ–΄ μΈμ¦ μ—†μ΄ μ ‘κ·Ό κ°€λ¥ β…
- μ—μ΄μ „νΈκ°€ μ •μƒ μ΄κΈ°ν™”λ¨ β…
- λ„κµ¬κ°€ μ •μƒ λ΅λ“λ¨ β…

---

### 3. JWT ν† ν° μƒμ„±/κ²€μ¦ ν…μ¤νΈ β…

**κ²°κ³Ό**: β… **μ„±κ³µ**
- ν† ν° μƒμ„±: μ •μƒ
- ν† ν° κ²€μ¦: μ •μƒ
- μ‚¬μ©μ μ •λ³΄ μ¶”μ¶: μ •μƒ

---

### 4. ν—¤λ” κ²€μ¦ ν…μ¤νΈ β…

#### X-Request-ID ν—¤λ”
- λ¨λ“  μ”μ²­μ— κ³ μ ν• Request ID μƒμ„± β…
- μ‘λ‹µ ν—¤λ”μ— ν¬ν•¨ β…

#### X-Tenant-ID ν—¤λ”
- μ”μ²­ ν—¤λ”μ—μ„ Tenant ID μ¶”μ¶ β…
- JWT ν† ν°μ `tenant_id` ν΄λ μ„κ³Ό μΌμΉ ν™•μΈ β…

---

## π” μμ • μ „ν›„ λΉ„κµ

### μμ • μ „
- `/agents/tools`: β "Not authenticated" (μ¬λ°”λ¥Έ ν† ν° μ‚¬μ© μ‹μ—λ„)
- λ΅κΉ…: κ²½λ΅ μ •λ³΄ λ¶€μ΅±
- μμ™Έ μ²λ¦¬: λ¶€μ΅±

### μμ • ν›„
- `/agents/tools`: β… μ •μƒ μ‘λ™ (μ¬λ°”λ¥Έ ν† ν° μ‚¬μ© μ‹)
- λ΅κΉ…: κ²½λ΅ μ •λ³΄ ν¬ν•¨, μƒμ„Έ λ΅κ·Έ
- μμ™Έ μ²λ¦¬: μ™„μ „ν• μμ™Έ μ²λ¦¬ λ° μ—λ¬ μ‘λ‹µ
- Fallback μΈμ¦: λ―Έλ“¤μ›¨μ–΄λ¥Ό ν†µκ³Όν•μ§€ λ»ν• κ²½μ°μ—λ„ μ‘λ™

---

## β… λ³΄μ™„ μ‚¬ν•­ κ²€μ¦

### 1. λ―Έλ“¤μ›¨μ–΄ κ°μ„  β…
- [x] EXEMPT_PATHSμ— `/agents/health` μ¶”κ°€
- [x] ν† ν° κ²€μ¦ μμ™Έ μ²λ¦¬ μ¶”κ°€
- [x] λ΅κΉ… κ°μ„  (κ²½λ΅ μ •λ³΄ ν¬ν•¨)

### 2. μμ΅΄μ„± μ£Όμ… κ°μ„  β…
- [x] Fallback μΈμ¦ λ΅μ§ μ¶”κ°€
- [x] `request.state.user` μ„¤μ • ν™•μΈ
- [x] λ΅κΉ… κ°μ„ 

### 3. μΈμ¦ νλ¦„ κ°μ„  β…
- [x] λ―Έλ“¤μ›¨μ–΄ β†’ μμ΅΄μ„± μ£Όμ… μ—°κ²° μ •μƒ
- [x] μΈμ¦ μ‹¤ν¨ μ‹ μ μ ν• μ—λ¬ μ‘λ‹µ
- [x] κ³µκ° μ—”λ“ν¬μΈνΈ μ •μƒ μ‘λ™

---

## π“ ν…μ¤νΈ ν†µκ³„

| μΉ΄ν…κ³ λ¦¬ | ν†µκ³Ό | μ‹¤ν¨ | ν†µκ³Όμ¨ |
|---------|------|------|--------|
| μΈμ¦ μ„±κ³µ ν…μ¤νΈ | 2 | 0 | 100% |
| μΈμ¦ μ‹¤ν¨ ν…μ¤νΈ | 2 | 0 | 100% |
| κ³µκ° μ—”λ“ν¬μΈνΈ | 1 | 0 | 100% |
| JWT ν† ν° ν…μ¤νΈ | 1 | 0 | 100% |
| **μ „μ²΄** | **6** | **0** | **100%** |

---

## π― κ²°λ΅ 

### β… λ³΄μ™„ μ„±κ³µ!

λ¨λ“  μμ • μ‚¬ν•­μ΄ μ •μƒμ μΌλ΅ μ‘λ™ν•©λ‹λ‹¤:

1. **μΈμ¦ μ‹μ¤ν… μ •μƒ μ‘λ™**
   - μ¬λ°”λ¥Έ ν† ν°μΌλ΅ λ³΄νΈλ μ—”λ“ν¬μΈνΈ μ ‘κ·Ό μ„±κ³µ β…
   - μΈμ¦ μ‹¤ν¨ μ‹ μ μ ν• μ—λ¬ μ‘λ‹µ β…

2. **λ―Έλ“¤μ›¨μ–΄ κ°μ„  μ™„λ£**
   - μμ™Έ μ²λ¦¬ μ¶”κ°€ β…
   - λ΅κΉ… κ°μ„  β…
   - EXEMPT_PATHS μ •μƒ μ‘λ™ β…

3. **μμ΅΄μ„± μ£Όμ… κ°μ„  μ™„λ£**
   - Fallback μΈμ¦ λ΅μ§ μ‘λ™ β…
   - `request.state.user` μ •μƒ μ„¤μ • β…

4. **μ „μ²΄ μΈμ¦ νλ¦„ μ •μƒ**
   - λ―Έλ“¤μ›¨μ–΄ β†’ μμ΅΄μ„± μ£Όμ… μ—°κ²° μ •μƒ β…
   - λ¨λ“  μ—”λ“ν¬μΈνΈ μ •μƒ μ‘λ™ β…

---

## π€ λ‹¤μ λ‹¨κ³„

### μ™„λ£λ μ‘μ—…
- [x] JWT μΈμ¦ μ‹μ¤ν… λ³΄μ™„
- [x] λ―Έλ“¤μ›¨μ–΄ κ°μ„ 
- [x] μμ΅΄μ„± μ£Όμ… κ°μ„ 
- [x] ν…μ¤νΈ κ²€μ¦ μ™„λ£

### λ‹¤μ ν…μ¤νΈ
- [ ] Redis μ—°κ²° ν…μ¤νΈ
- [ ] Backend μ—°λ™ ν…μ¤νΈ (dwp_backend)
- [ ] Frontend μ—°λ™ ν…μ¤νΈ (dwp_frontend)
- [ ] μ „μ²΄ ν†µν•© ν…μ¤νΈ

---

## π“ μ°Έκ³  μ‚¬ν•­

### μ£Όμ: OpenAI API ν‚¤ ν•„μ”
`/agents/chat` μ—”λ“ν¬μΈνΈλ” OpenAI API ν‚¤κ°€ ν•„μ”ν•©λ‹λ‹¤.
ν„μ¬ ν…μ¤νΈμ—μ„λ” μΈμ¦μ€ μ„±κ³µν–μ§€λ§, LLM νΈμ¶μ—μ„ API ν‚¤ μ¤λ¥κ°€ λ°μƒν–μµλ‹λ‹¤.

**ν•΄κ²° λ°©λ²•**:
```bash
# .env νμΌμ— μ‹¤μ  OpenAI API ν‚¤ μ„¤μ •
OPENAI_API_KEY=sk-your-actual-api-key-here
```

---

**β… λ¨λ“  λ³΄μ™„ μ‚¬ν•­μ΄ μ„±κ³µμ μΌλ΅ κ²€μ¦λμ—μµλ‹λ‹¤!**

**μ΄μ  λ‹¤μ ν…μ¤νΈ λ‹¨κ³„λ΅ μ§„ν–‰ν•  μ μμµλ‹λ‹¤.** π‰
